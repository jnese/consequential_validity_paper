# Appendix

(ref:tbl-cor-cap) Correlations between CBM-R Predictors (CORE and Traditional) and Continuous Outcomes (Spring CBM Comprehension and SBAC ELA/L) by Grade.

```{r tbl-cor, results="asis"}

cor_comp <- data_comp %>% 
  select(grade_core, wcpm_core.wave1_r, wcpm_easycbmcore.wave1_r, wcpm_core.wave4_r, wcpm_easycbmcore.wave4_r, readingcomp_easycbm.spring) %>% 
  group_by(grade_core) %>% 
  summarize(core_fall = cor(wcpm_core.wave1_r, readingcomp_easycbm.spring, use = "pairwise.complete.obs"),
            trad_fall = cor(wcpm_easycbmcore.wave1_r, readingcomp_easycbm.spring, use = "pairwise.complete.obs"),
            core_spring = cor(wcpm_core.wave4_r, readingcomp_easycbm.spring, use = "pairwise.complete.obs"),
            trad_spring = cor(wcpm_easycbmcore.wave4_r, readingcomp_easycbm.spring, use = "pairwise.complete.obs")
  ) %>% 
  mutate(measure = "CBM Comprehension")
            
cor_sbac <- data_sbac %>% 
  select(grade_core, wcpm_core.wave1_r, wcpm_easycbmcore.wave1_r, wcpm_core.wave4_r, wcpm_easycbmcore.wave4_r, sbac_score) %>% 
  group_by(grade_core) %>%  
  summarize(
    core_fall = cor(wcpm_core.wave1_r, sbac_score, use = "pairwise.complete.obs"),
    trad_fall = cor(wcpm_easycbmcore.wave1_r, sbac_score, use = "pairwise.complete.obs"),
    core_spring = cor(wcpm_core.wave4_r, sbac_score, use = "pairwise.complete.obs"),
    trad_spring = cor(wcpm_easycbmcore.wave4_r, sbac_score, use = "pairwise.complete.obs")
    ) %>% 
  mutate(measure = "SBAC ELA/L Score")

cor_info <- cor_comp %>% 
  bind_rows(cor_sbac) %>% 
  mutate(across(c(core_fall:trad_spring), ~str_sub(sprintf("%.2f", round(., 2)), 2)))

variable_labels(cor_info$core_fall) <- "CORE"
variable_labels(cor_info$trad_fall) <- "Traditional"
variable_labels(cor_info$core_spring) <- "CORE"
variable_labels(cor_info$trad_spring) <- "Traditional"

cor_info <- cor_info %>%
  rename(Grade = grade_core) %>% 
  mutate(Grade = paste0("Grade ", Grade)) %>% 
  group_by(measure) %>% 
  nest()

apa_table(
  list(
    `CBM Comprehension` = cor_info$data[[1]],
    `SBAC ELA/L Score` = cor_info$data[[2]]
    ), 
  caption = "(ref:tbl-cor-cap)", 
  col_spanners = list(`Distal (Fall)` = c(2, 3), `Proximal (Spring)` = c(4, 5)),
  align = c("l", rep("r", 4)),
  escape = FALSE
  ) 

```


(ref:tbl-lgms-results-cap) Latent Growth Model Parameter Estimates by Grade.

```{r tbl-lgms-results, results='asis'}

lgms_info <- lgms %>% 
  mutate(paramtable = map(params, paramtable_fx)) %>% 
  select(Grade = grade_core, measure, paramtable) %>% 
  arrange(Grade, measure) %>% 
  pivot_wider(
    names_from = measure,
    values_from = paramtable
  ) %>% 
  unnest() %>% 
  select(-param_names1) %>% 
  mutate(across(c(parameter1:z1), ~ifelse(Grade == 4, "", .)),
         across(c(parameter:z1), ~ifelse(. == "", "--", .)),
         Grade = paste0("Grade ", Grade)) %>% 
  rename(`Parameter Names` = param_names,
         Parameter = parameter) %>% 
  as.data.frame(.)

variable_labels(lgms_info$se) <- "\\emph{SE}"
variable_labels(lgms_info$z) <- "\\emph{z}-value"
variable_labels(lgms_info$parameter1) <- "Parameter"
variable_labels(lgms_info$se1) <- "\\emph{SE}"
variable_labels(lgms_info$z1) <- "\\emph{z}-value"

lgms_info <- lgms_info %>% 
  group_by(Grade) %>% 
  nest()

apa_table(
  list(
    `Grade 2` = lgms_info$data[[1]],
    `Grade 3` = lgms_info$data[[2]],
    `Grade 4` = lgms_info$data[[3]]
    ), 
  col_spanners = list(`CORE` = c(2, 4), `Traditional` = c(5, 7)),
  caption = "(ref:tbl-lgms-results-cap)", 
  align = c("l", rep("r", 6)),
  longtable = TRUE,
  escape = FALSE
  )
```
