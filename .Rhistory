mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(values) %>%
gt(groupname_col = "demo", rowname_col = "values") %>%
row_group_order(
groups = c("Grade", "Gender", "Ethnicity", "Free/Reduced Lunch",
"Students with Disabilities (SWD)", "English Language Learners (EL)",
"School District",
"School")
) %>%
cols_align(
align = "right",
columns = starts_with("stat")
) %>%
tab_spanner(
label = "RQ 1",
columns = vars(stat.x)
) %>%
tab_spanner(
label = "RQ 2",
columns = vars(stat.y)
) %>%
tab_spanner(
label = "RQ 3",
columns = vars(stat)
) %>%
cols_label(
values = "",
stat.x = md(paste0("*N* = ", nrow(data_r))),
stat.y = md(paste0("*N* = ", nrow(data_comp))),
stat = md(paste0("*N* = ", nrow(data_sbac)))
) %>%
apa_format_fx() %>%
tab_header(
title = html("Table 1.<br><br><i>Sample Characteristics by Research Question</i>")) %>%
opt_align_table_header(align = c("left")) %>%
as_html()
title = html("Table 1.<br><br><i>Sample Characteristics by Research Question</i>")) %>%
opt_align_table_header(align = c("left")) %>%
as_raw_html()
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(values) %>%
gt(groupname_col = "demo", rowname_col = "values") %>%
row_group_order(
groups = c("Grade", "Gender", "Ethnicity", "Free/Reduced Lunch",
"Students with Disabilities (SWD)", "English Language Learners (EL)",
"School District",
"School")
) %>%
cols_align(
align = "right",
columns = starts_with("stat")
) %>%
tab_spanner(
label = "RQ 1",
columns = vars(stat.x)
) %>%
tab_spanner(
label = "RQ 2",
columns = vars(stat.y)
) %>%
tab_spanner(
label = "RQ 3",
columns = vars(stat)
) %>%
cols_label(
values = "",
stat.x = md(paste0("*N* = ", nrow(data_r))),
stat.y = md(paste0("*N* = ", nrow(data_comp))),
stat = md(paste0("*N* = ", nrow(data_sbac)))
) %>%
apa_format_fx() %>%
tab_header(
title = html("Table 1.<br><br><i>Sample Characteristics by Research Question</i>")) %>%
opt_align_table_header(align = c("left")) %>%
as_raw_html()
foo
demos_fx(data_r) %>%
group_by(demo)
demos_fx(data_r) %>%
group_by(demo) %>%
nest() %>%
arrange(demo)
demos_fx(data_r) %>%
group_by(demo) %>%
nest() %>%
mutate(
demo = fct_relevel(demo,
"Grade",
"Gender",
"Ethnicity",
"Free/Reduced Lunch",
"Students with Disabilities (SWD)",
"English Language Learners (EL)",
"School District",
"School")
)
demos_fx(data_r)
demos_fx(data_r) %>%
mutate(
demo = fct_relevel(demo,
"Grade",
"Gender",
"Ethnicity",
"Free/Reduced Lunch",
"Students with Disabilities (SWD)",
"English Language Learners (EL)",
"School District",
"School")
) %>%
group_by(demo) %>%
nest()
demos_fx(data_r)
demos_fx(data_r) %>%
mutate(
demo = fct_relevel(demo,
"Grade",
"Gender",
"Ethnicity",
"Free/Reduced Lunch",
"Students with Disabilities (SWD)",
"English Language Learners (EL)",
"School District",
"School")
)
demos_fx(data_r) %>%
mutate(
demo = fct_relevel(demo,
"Grade",
"Gender",
"Ethnicity",
"Free/Reduced Lunch",
"Students with Disabilities (SWD)",
"English Language Learners (EL)",
"School District",
"School")
)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values"))
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .)))
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
group_by(demo) %>%
nest()
demos_fx <- function(df){
df %>%
select(grade_core, gender_state, ethnicity_state, frl_state, sped_state, lep_state, district_core, school_core) %>%
mutate(across(everything(), ~ifelse(is.na(.), "Missing", .)),
across(c(frl_state, sped_state, lep_state), ~recode(., "N" = "No", "Y" = "Yes")),
across(c(frl_state, sped_state, lep_state), ~fct_expand(., "Yes","No", "Missing")),
across(c(frl_state, sped_state, lep_state), ~fct_relevel(., "Yes","No", "Missing")),
grade_core = paste("Grade", grade_core)) %>%
pivot_longer(
cols = everything(),
names_to = "demo",
values_to = "values"
) %>%
mutate(
demo = recode(demo,
grade_core = "Grade",
gender_state = "Gender",
ethnicity_state = "Ethnicity",
frl_state = "Free/Reduced Lunch",
sped_state = "Students with Disabilities (SWD)",
lep_state = "English Language Learners (EL)",
district_core = "School District",
school_core = "School")
) %>%
group_by(demo, values) %>%
summarize(n = n(),
pct = round(n/nrow(df) * 100, 0),
stat = paste0(n, " (", pct, "%)")) %>%
select(demo, values, stat) %>%
group_by(demo) %>%
nest()
}
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values"))
demos_fx(data_r)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo")) %>%
left_join(demos_fx(data_sbac), by = c("demo"))
demos_fx <- function(df){
df %>%
select(grade_core, gender_state, ethnicity_state, frl_state, sped_state, lep_state, district_core, school_core) %>%
mutate(across(everything(), ~ifelse(is.na(.), "Missing", .)),
across(c(frl_state, sped_state, lep_state), ~recode(., "N" = "No", "Y" = "Yes")),
across(c(frl_state, sped_state, lep_state), ~fct_expand(., "Yes","No", "Missing")),
across(c(frl_state, sped_state, lep_state), ~fct_relevel(., "Yes","No", "Missing")),
grade_core = paste("Grade", grade_core)) %>%
pivot_longer(
cols = everything(),
names_to = "demo",
values_to = "values"
) %>%
mutate(
demo = recode(demo,
grade_core = "Grade",
gender_state = "Gender",
ethnicity_state = "Ethnicity",
frl_state = "Free/Reduced Lunch",
sped_state = "Students with Disabilities (SWD)",
lep_state = "English Language Learners (EL)",
district_core = "School District",
school_core = "School")
) %>%
group_by(demo, values) %>%
summarize(n = n(),
pct = round(n/nrow(df) * 100, 0),
stat = paste0(n, " (", pct, "%)")) %>%
select(demo, values, stat) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
group_by(demo) %>%
nest()
}
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo")) %>%
left_join(demos_fx(data_sbac), by = c("demo"))
demo_order <- c("Grade", "Gender", "Ethnicity", "Free/Reduced Lunch", "Students with Disabilities (SWD)", "English Language Learners (EL)", "School District", "School")
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo")) %>%
left_join(demos_fx(data_sbac), by = c("demo")) %>%
arrange(match(demo, demo_order))
names(foo)[2:4] <- c(paste0("N = ", nrow(data_r)), paste0("N = ", nrow(data_comp)), paste0("N = ", nrow(data_sbac)))
c(paste0("N = ", nrow(data_r)), paste0("N = ", nrow(data_comp)), paste0("N = ", nrow(data_sbac)))
names(foo)[2:4]
foo <- demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo")) %>%
left_join(demos_fx(data_sbac), by = c("demo")) %>%
arrange(match(demo, demo_order))
names(foo)[2:4]
names(foo)[2:4] <- c(paste0("N = ", nrow(data_r)), paste0("N = ", nrow(data_comp)), paste0("N = ", nrow(data_sbac)))
foo
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo")) %>%
left_join(demos_fx(data_sbac), by = c("demo")) %>%
arrange(match(demo, demo_order))
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo")) %>%
left_join(demos_fx(data_sbac), by = c("demo")) %>%
arrange(match(demo, demo_order)) %>%
unnest()
demos_fx <- function(df){
df %>%
select(grade_core, gender_state, ethnicity_state, frl_state, sped_state, lep_state, district_core, school_core) %>%
mutate(across(everything(), ~ifelse(is.na(.), "Missing", .)),
across(c(frl_state, sped_state, lep_state), ~recode(., "N" = "No", "Y" = "Yes")),
across(c(frl_state, sped_state, lep_state), ~fct_expand(., "Yes","No", "Missing")),
across(c(frl_state, sped_state, lep_state), ~fct_relevel(., "Yes","No", "Missing")),
grade_core = paste("Grade", grade_core)) %>%
pivot_longer(
cols = everything(),
names_to = "demo",
values_to = "values"
) %>%
mutate(
demo = recode(demo,
grade_core = "Grade",
gender_state = "Gender",
ethnicity_state = "Ethnicity",
frl_state = "Free/Reduced Lunch",
sped_state = "Students with Disabilities (SWD)",
lep_state = "English Language Learners (EL)",
district_core = "School District",
school_core = "School")
) %>%
group_by(demo, values) %>%
summarize(n = n(),
pct = round(n/nrow(df) * 100, 0),
stat = paste0(n, " (", pct, "%)")) %>%
select(demo, values, stat)
}
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(values)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(values)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values) %>%
column_to_rownames(demo)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values) %>%
column_to_rownames(demo = "rowname")
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
ungroup() %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values) %>%
column_to_rownames(var = "demo")
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values"))
?rename
demos_fx <- function(df){
tbl <- df %>%
select(grade_core, gender_state, ethnicity_state, frl_state, sped_state, lep_state, district_core, school_core) %>%
mutate(across(everything(), ~ifelse(is.na(.), "Missing", .)),
across(c(frl_state, sped_state, lep_state), ~recode(., "N" = "No", "Y" = "Yes")),
across(c(frl_state, sped_state, lep_state), ~fct_expand(., "Yes","No", "Missing")),
across(c(frl_state, sped_state, lep_state), ~fct_relevel(., "Yes","No", "Missing")),
grade_core = paste("Grade", grade_core)) %>%
pivot_longer(
cols = everything(),
names_to = "demo",
values_to = "values"
) %>%
mutate(
demo = recode(demo,
grade_core = "Grade",
gender_state = "Gender",
ethnicity_state = "Ethnicity",
frl_state = "Free/Reduced Lunch",
sped_state = "Students with Disabilities (SWD)",
lep_state = "English Language Learners (EL)",
district_core = "School District",
school_core = "School")
) %>%
group_by(demo, values) %>%
summarize(n = n(),
pct = round(n/nrow(df) * 100, 0),
stat = paste0(n, " (", pct, "%)")) %>%
select(demo, values, stat) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .)))
names(tbl)[3] <- paste0("N = ", nrow(df))
tbl
# group_by(demo) %>%
# nest()
}
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values"))
demos_fx <- function(df){
tbl <- df %>%
select(grade_core, gender_state, ethnicity_state, frl_state, sped_state, lep_state, district_core, school_core) %>%
mutate(across(everything(), ~ifelse(is.na(.), "Missing", .)),
across(c(frl_state, sped_state, lep_state), ~recode(., "N" = "No", "Y" = "Yes")),
across(c(frl_state, sped_state, lep_state), ~fct_expand(., "Yes","No", "Missing")),
across(c(frl_state, sped_state, lep_state), ~fct_relevel(., "Yes","No", "Missing")),
grade_core = paste("Grade", grade_core)) %>%
pivot_longer(
cols = everything(),
names_to = "demo",
values_to = "values"
) %>%
mutate(
demo = recode(demo,
grade_core = "Grade",
gender_state = "Gender",
ethnicity_state = "Ethnicity",
frl_state = "Free/Reduced Lunch",
sped_state = "Students with Disabilities (SWD)",
lep_state = "English Language Learners (EL)",
district_core = "School District",
school_core = "School")
) %>%
group_by(demo, values) %>%
summarize(n = n(),
pct = round(n/nrow(df) * 100, 0),
stat = paste0(n, " (", pct, "%)")) %>%
select(demo, values, stat) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .)))
names(tbl)[3] <- paste0("<i>N</> = ", nrow(df))
tbl
# group_by(demo) %>%
# nest()
}
demo_order <- c("Grade", "Gender", "Ethnicity", "Free/Reduced Lunch", "Students with Disabilities (SWD)", "English Language Learners (EL)", "School District", "School")
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values"))
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(c(3:5), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values)
demos_fx <- function(df){
tbl <- df %>%
select(grade_core, gender_state, ethnicity_state, frl_state, sped_state, lep_state, district_core, school_core) %>%
mutate(across(everything(), ~ifelse(is.na(.), "Missing", .)),
across(c(frl_state, sped_state, lep_state), ~recode(., "N" = "No", "Y" = "Yes")),
across(c(frl_state, sped_state, lep_state), ~fct_expand(., "Yes","No", "Missing")),
across(c(frl_state, sped_state, lep_state), ~fct_relevel(., "Yes","No", "Missing")),
grade_core = paste("Grade", grade_core)) %>%
pivot_longer(
cols = everything(),
names_to = "demo",
values_to = "values"
) %>%
mutate(
demo = recode(demo,
grade_core = "Grade",
gender_state = "Gender",
ethnicity_state = "Ethnicity",
frl_state = "Free/Reduced Lunch",
sped_state = "Students with Disabilities (SWD)",
lep_state = "English Language Learners (EL)",
district_core = "School District",
school_core = "School")
) %>%
group_by(demo, values) %>%
summarize(n = n(),
pct = round(n/nrow(df) * 100, 0),
stat = paste0(n, " (", pct, "%)")) %>%
select(demo, values, stat) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("stat"), ~ifelse(is.na(.), "--", .)))
names(tbl)[3] <- paste0("<i>N</> = ", nrow(df))
tbl
# group_by(demo) %>%
# nest()
}
demo_order <- c("Grade", "Gender", "Ethnicity", "Free/Reduced Lunch", "Students with Disabilities (SWD)", "English Language Learners (EL)", "School District", "School")
demos_fx(data_r)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values"))
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(c(3:5), ~ifelse(is.na(.), "--", .)))
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf)
)
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("<"), ~ifelse(is.na(.), "--", .)))
demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("<"), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values)
foo <- demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("<"), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values)
foo
foo <- demos_fx(data_r) %>%
left_join(demos_fx(data_comp), by = c("demo", "values")) %>%
left_join(demos_fx(data_sbac), by = c("demo", "values")) %>%
mutate(values = fct_relevel(values, "Missing", after = Inf),
across(starts_with("<"), ~ifelse(is.na(.), "--", .))) %>%
arrange(match(demo, demo_order), values) %>%
group_by(demo) %>%
nest()
foo
foo$data[[1]]
foo$data[[2]]
foo
foo$data[[8]]
?apa_table
